mikan = <<~END
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000222222222222000000000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002222222222000000000022220000000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000222222000000000000000000000000002222222200000000000000000000222200000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000002222222220000000000000000000000000222200000000000000000000000000002222000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000002222222220000000000000000000000000220000000000000000000000000000000022220000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000002222222220000000000000000000000022222222222222222222222200000000000000222200000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000022220000000000000000000000000022222200000000000000002222220000000000000022222200000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000022222200000022222200000000222200000000000000000000000000222222000000000000002222000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000222200002222002222220022222222222200000000000000000000000000222200000000000022222200000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000222200222200000000222222000000002200000000000000000000000000002222000000000000002222000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000222222220000000000000000000000000022000000000000000000000000000022000000000000000022220000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000222222000000000000000000000000000022000000000000000000000000000022220000000000000000220000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000002222000000000000000000000000000022000000000000000000000000000000220000000000000000220000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000022220000000000000000000000000000222200000000000000220000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000222222222200000000000000000000002200000000000000220000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000002222222222222200000000002222000000000000220000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000002222222222222200000000002222000000000000220000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111110000000000000000000000000000002222000000000022000000000000222200000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000111111000022220000000000000000111111110000000000000000000000000022220000000022220000000000002222000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000001111111111000000002222220000222200000000000000111111110000000000000000000000222200000000002222000000000022000000000000000000
  000000000000000000000000000000000000000000000000000000000000001111111100000000002222222222222222222200000000000000000000111111110000000000000000002222000000000000222222000022000000000000000000
  000000000000000000000000000000000000000000000000000000000011111100000000000000000000222222222200000000000000000000000000000000111111000000000000000022222200000000000022222222000000000000000000
  000000000000000000000000000000000000000000000000000000001111000000000000000000000000222222002222000000000000000000000000000000000000111111000000000000002222222222222200002222220000000000000000
  000000000000000000000000000000000000000000000000000011111100000000000000000000000022222200000022000000000000000000000000000000000000000011111111000000000000000000002222222222220000000000000000
  000000000000000000000000000000000000000000000000001111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011110000000000000000000000002222000000000000000000
  000000000000000000000000000000000000000000000000111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111000000000000000000000022220000000000000000
  000000000000000000000000000000000000000000000011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011110000000000000000000022220000000000000000
  000000000000000000000000000000000000000000111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111100000000000000000000220000000000000000
  000000000000000000000000000000000000000000110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111000000000000000000220000000000000000
  000000000000000000000000000000000000000011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000220000000000000000
  000000000000000000000000000000000000001111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111100000000000000222200000000000000
  000000000000000000000000000000000000111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111000000000000002222000000000000
  000000000000000000000000000000000000110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011000000000000000022000000000000
  000000000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011000000000000000000000000000000
  000000000000000000000000000000001111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011110000000000000000000000000000
  000000000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000
  000000000000000000000000000000110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000
  000000000000000000000000000000110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000
  000000000000000000000000000000110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000
  000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000
  000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000
  000000000000000000000000001111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000
  000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000
  000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011110000000000000000000000000000
  000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011000000000000000000000000000000
  000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011000000000000000000000000000000
  000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011000000000000000000000000000000
  000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011000000000000000000000000000000
  000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111000000000000000000000000000000
  000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001100000000000000000000000000000000
  000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001100000000000000000000000000000000
  000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111100000000000000000000000000000000
  000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000000000
  000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011110000000000000000000000000000000000
  000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011000000000000000000000000000000000000
  000000000000000000000000000000110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001100000000000000000000000000000000000000
  000000000000000000000000000000111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111100000000000000000000000000000000000000
  000000000000000000000000000000001111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011000000000000000000000000000000000000000000
  000000000000000000000000000000000011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111000000000000000000000000000000000000000000
  000000000000000000000000000000000000001111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011110000000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111000000000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000001111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111100000000000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000001111000000000000000000000000000000000000000000000000000000000000000000000000000000001111000000000000000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000111111000000000000000000000000000000000000000000000000000000000000000000000011110000000000000000000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000011111100000000000000000000000000000000000000000000000000000000000000111111000000000000000000000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000001111111100000000000000000000000000000000000000000000000011111111000000000000000000000000000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000001111110000000000000000000000000000000000000000111111000000000000000000000000000000000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000001111110000000000000000000000000000111111110000000000000000000000000000000000000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
END

# みかんの形状データをバイナリ配列に変換
mikan_lines = mikan.split("\n")
width = mikan_lines[0].length
height = mikan_lines.length

# みかんの形状全体（1と2の部分）をビットマップとして変換
bitmap = Array.new(height * width, 0)
height.times do |y|
  width.times do |x|
    # 1か2の場合は1、それ以外は0
    bitmap[y * width + x] = 1 if %w[1 2].include?(mikan_lines[y][x])
  end
end

# バイナリデータをMarshal.dumpでシリアライズし、Base64エンコード
mikan_bits = [Marshal.dump(bitmap)].pack('m0')

# 葉の部分の範囲定義 (コンパクトにするために変数に代入せず直接使用)
leaf_ranges = [324..335, 506..515, 526..529, 660..665, 692..699, 720..723, 848..856, 882..885, 914..917, 1040..1048, 1074..1075,
               1108..1111, 1232..1240, 1264..1287, 1302..1305, 1426..1429, 1456..1461, 1478..1483, 1498..1503, 1618..1623, 1630..1635, 1644..1647, 1674..1679, 1694..1697, 1812..1815, 1820..1823, 1826..1831, 1834..1845, 1872..1875, 1888..1893, 2004..2007, 2010..2013, 2022..2027, 2036..2037, 2066..2069, 2084..2087, 2196..2203, 2230..2231, 2260..2261, 2278..2281, 2388..2393, 2422..2423, 2452..2455, 2472..2473, 2582..2585, 2614..2615, 2646..2647, 2664..2665, 2776..2777, 2806..2809, 2838..2841, 2856..2857, 2968..2969, 3000..3009, 3032..3033, 3048..3049, 3160..3161, 3200..3213, 3224..3227, 3240..3241, 3352..3353, 3392..3405, 3416..3419, 3432..3433, 3596..3599, 3610..3611, 3624..3627, 3736..3739, 3790..3793, 3802..3805, 3818..3821, 3926..3931, 3936..3939, 3984..3987, 3998..4001, 4012..4013, 4112..4131, 4178..4181, 4194..4199, 4204..4205, 4308..4317, 4372..4377, 4390..4397, 4500..4505, 4508..4511, 4568..4581, 4586..4591, 4690..4695, 4702..4703, 4772..4783, 4970..4973, 5164..5167, 5356..5359, 5550..5551, 5742..5743, 5934..5935, 6126..6129, 6320..6323, 6514..6515]

start_text = 'eval$s=%w'
end_text = '.join'

code = "c=eval(\"#{leaf_ranges}\").flat_map(&:to_a);n=Marshal.load(\"#{mikan_bits}\".unpack(\"m\")[0]);l=39.chr;m=27.chr;e=\"#{start_text}\"+l+($s*2);o=\"\";j=-1;0.upto(n.size-1){|i|t=(c.include?(i)?34:208);o<<(n[i]==1?(m+\"[38;5;\"+t.to_s+\"m\"+e[j+=1]+m+\"[0m\"):32);o<<(i%#{width}==#{width - 1}?10:\"\")};o[-85,6]=l+\"#{end_text}\";1000.times{|k|puts(m+\"[2J\");pos_y=10+(Math.sin(k*0.5)*10).to_i;puts(m+\"[\"+pos_y.to_s+\";10H\");puts(o);sleep(0.1)}#"

file = File.new('mikan6.rb', 'w')
file.puts "#{start_text}'#{code}'#{end_text}"
